<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Beginning Swift Programming Part 15 — Enums with Generics and Closures</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Beginning Swift Programming Part 15 — Enums with Generics and Closures</h1>
</header>
<section data-field="subtitle" class="p-summary">
In the previous article, we talked about error handling.
</section>
<section data-field="body" class="e-content">
<section name="1594" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="72db" id="72db" class="graf graf--h3 graf--leading graf--title">Beginning Swift Programming Part 15 — Enums with Generics and Closures</h3><figure name="648e" id="648e" class="graf graf--figure graf-after--h3"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 464px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 66.2%;"></div><img class="graf-image" data-image-id="0*e5zlbGnmy3CuedXn." data-width="3000" data-height="1987" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/0*e5zlbGnmy3CuedXn."></div><figcaption class="imageCaption">Photo by <a href="https://unsplash.com/@kellysikkema?utm_source=medium&amp;utm_medium=referral" data-href="https://unsplash.com/@kellysikkema?utm_source=medium&amp;utm_medium=referral" class="markup--anchor markup--figure-anchor" rel="photo-creator noopener" target="_blank">Kelly Sikkema</a> on <a href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" data-href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" class="markup--anchor markup--figure-anchor" rel="photo-source noopener" target="_blank">Unsplash</a></figcaption></figure><p name="4dc5" id="4dc5" class="graf graf--p graf-after--figure">In the previous article, we talked about error handling.</p><div name="ad47" id="ad47" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://medium.com/@broebling/beginning-swift-programming-part-14-error-handling-919dea6771b0" data-href="https://medium.com/@broebling/beginning-swift-programming-part-14-error-handling-919dea6771b0" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/@broebling/beginning-swift-programming-part-14-error-handling-919dea6771b0"><strong class="markup--strong markup--mixtapeEmbed-strong">Beginning Swift Programming Part 14 — Error Handling</strong><br><em class="markup--em markup--mixtapeEmbed-em">In the previous article we talked about generics.</em>medium.com</a><a href="https://medium.com/@broebling/beginning-swift-programming-part-14-error-handling-919dea6771b0" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="eb5c793b82a6fc93d4b14a02d710e286" data-thumbnail-img-id="0*oTTfiAAesQT1iyOo." style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*oTTfiAAesQT1iyOo.);"></a></div><p name="9e51" id="9e51" class="graf graf--p graf-after--mixtapeEmbed">We covered the basics on how to create your own errors and use them in code instead of just crashing.</p><p name="b961" id="b961" class="graf graf--p graf-after--p">If you are interested to know, I only have 5 more topics left and then I’ll point you to some of my favorite resources that helped me write programs.</p><p name="ba21" id="ba21" class="graf graf--p graf-after--p">This article is going to be short, but it will blend a few concepts that we’ve learned and may make you think about how you write code in a new way.</p><h3 name="bafd" id="bafd" class="graf graf--h3 graf-after--p">Enums with Generics and Closures</h3><p name="87bf" id="87bf" class="graf graf--p graf-after--h3">Previously when we talked about enums, I told you that it would give you options to chose from and that we were locked down to only those options. We can use associated values in our enum cases to define the type that will be instantiated when we use the Enum.</p><figure name="06f7" id="06f7" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mildocjr/3075e5cec4ea9fba7fa706ada569ef25.js"></script></figure><p name="4a33" id="4a33" class="graf graf--p graf-after--figure">Pretty cool right? If we don’t know what type will be entered we can use generics.</p><figure name="dd09" id="dd09" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mildocjr/f9691fa9be711c73a8aef8779a84738a.js"></script></figure><p name="0ad4" id="0ad4" class="graf graf--p graf-after--figure">This allows us to use any type when we create a new <code class="markup--code markup--p-code">address</code> or <code class="markup--code markup--p-code">coordinate</code>.</p><figure name="05b7" id="05b7" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 467px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 66.7%;"></div><img class="graf-image" data-image-id="0*OAe2UF4Q80f2JcMF." data-width="5760" data-height="3840" src="https://cdn-images-1.medium.com/max/800/0*OAe2UF4Q80f2JcMF."></div><figcaption class="imageCaption">Photo by <a href="https://unsplash.com/@markusspiske?utm_source=medium&amp;utm_medium=referral" data-href="https://unsplash.com/@markusspiske?utm_source=medium&amp;utm_medium=referral" class="markup--anchor markup--figure-anchor" rel="photo-creator noopener" target="_blank">Markus Spiske</a> on <a href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" data-href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" class="markup--anchor markup--figure-anchor" rel="photo-source noopener" target="_blank">Unsplash</a></figcaption></figure><p name="12f8" id="12f8" class="graf graf--p graf-after--figure">Now I told you about using closures, enums, and generics altogether. This is a cool trick I learned from <a href="https://www.natashatherobot.com" data-href="https://www.natashatherobot.com" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Natasha the Robot</a> and I’ve used it a lot in my own code.</p><figure name="27e6" id="27e6" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mildocjr/88e634b9130c9c97487b0b6fb595cffa.js"></script></figure><p name="8e87" id="8e87" class="graf graf--p graf-after--figure">I would be lying if I told you this was easy to understand. Even with whitespace, this is still pretty difficult. So I’m going to break it down.</p><p name="1c9a" id="1c9a" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">struct Download</code> — The struct that holds our logic. Might be a class since it’s doing network calls.</p><figure name="ae1e" id="ae1e" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mildocjr/f0157b147a8a6e974ead43ea2f1041a2.js"></script></figure><p name="467b" id="467b" class="graf graf--p graf-after--figure">This gives us one of two options, either <code class="markup--code markup--p-code">.success(anything)</code> or <code class="markup--code markup--p-code">.failure(someError)</code>.</p><p name="b165" id="b165" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">func start(_ completion: @escaping (Result&lt;T&gt;) -&gt; Void) { }</code></p><p name="86f1" id="86f1" class="graf graf--p graf-after--p">This is a method that takes a function. The function takes a case from our <code class="markup--code markup--p-code">Result</code> Enum and returns nothing.</p><p name="518e" id="518e" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">let session</code> — creates a session from <code class="markup--code markup--p-code">URLSession</code> with an <code class="markup--code markup--p-code">ephemeral</code> configuration. Ephemeral means in-memory only, or the equivalent of private browsing.</p><p name="9bb8" id="9bb8" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">let url</code> — creates a URL from the string we pass in, this would be whatever web page you want to download from.</p><p name="ba58" id="ba58" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">let task = session.dataTask(with:URL) { data, response, error in ... }</code> provides us with a task that we can use to download our data. Think of this as the horse you ride to get where you are going. <code class="markup--code markup--p-code">data</code> is the binary (1s and 0s) data you receive, <code class="markup--code markup--p-code">response</code> is the response headers that you receive. More on this in a sec. <code class="markup--code markup--p-code">error</code> is if <em class="markup--em markup--p-em">our</em> call failed. This is important. If you receive a 404 page not found error in your call, then you would get that information from the<code class="markup--code markup--p-code">response</code>. Even if you got a 500 which means something on their server failed, you’d still get this in <code class="markup--code markup--p-code">response</code>. <code class="markup--code markup--p-code">error</code> for us means, we could not do what we needed to do to even initiate the request. WE failed, not THEY failed.</p><p name="7af3" id="7af3" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">guard error == nil else { ... }</code> — this is a pre-flight check we perform. If we received an error there is no need to go on, we just return the error here and exit.</p><p name="645d" id="645d" class="graf graf--p graf-after--p">You already know about <code class="markup--code markup--p-code">DispatchQueue.main.async</code> so I’ll just talk about <code class="markup--code markup--p-code">defer { session.invalidateAndCancel() }</code>. Invalidate and cancel means stop whatever you are doing and get rid of <code class="markup--code markup--p-code">session</code>, we don’t need it anymore. But I bet you were asking about <code class="markup--code markup--p-code">defer</code>. <code class="markup--code markup--p-code">defer</code> is used when we want this bit of code to run no matter what, but wait until this method is finished before running. It’s like a <code class="markup--code markup--p-code">deinit</code> for your methods, functions, and closures.</p><p name="51e1" id="51e1" class="graf graf--p graf-after--p">Then we use <code class="markup--code markup--p-code">completion(.failure(error!)</code>. <code class="markup--code markup--p-code">completion</code> comes from the parameter name in <code class="markup--code markup--p-code">start</code>. <code class="markup--code markup--p-code">.failure</code> is a case from our <code class="markup--code markup--p-code">Result</code> enum. And <code class="markup--code markup--p-code">error!</code> is the force unwrapped error we received from our closure. It’s ok in this situation because we already checked if it was nil and since this code executed, it means it wasn’t nil.</p><p name="2fb0" id="2fb0" class="graf graf--p graf-after--p">Then we do a little more checking.</p><p name="dcc3" id="dcc3" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">if let httpResponse = response as? HTTPURLResponse</code> — unfortunately Swift doesn’t give us direct access to the status code, however, <code class="markup--code markup--p-code">HTTPURLResponse</code> does and we can typecast response as an HTTPURLResponse and it should succeed. If it does, we immediately check to see if we had a successful response with <code class="markup--code markup--p-code">if httpResponse.statusCode == 200</code>.</p><p name="4994" id="4994" class="graf graf--p graf-after--p">If both of those are true then we can safely send back our data to be parsed or whatever we are going to do with it. First, we make sure we are doing this on the main queue with <code class="markup--code markup--p-code">DispatchQueue.main.async</code> then use our completion handler to do this with <code class="markup--code markup--p-code">completion(.success(data!))</code> force unwrapping data because all three of our closure parameters are optional values.</p><p name="449b" id="449b" class="graf graf--p graf-after--p">At the end of the <code class="markup--code markup--p-code">start</code> function, we call <code class="markup--code markup--p-code">task.resume()</code> which kicks off the data task. When the call is completed, then we run through all of that code we walked through previously.</p><p name="0eb2" id="0eb2" class="graf graf--p graf-after--p">To show you how this would look on the other side where we call <code class="markup--code markup--p-code">start</code> it might look something like this.</p><figure name="173b" id="173b" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mildocjr/56bf56ab13935a6530e99c072b9c894e.js"></script></figure><h3 name="1951" id="1951" class="graf graf--h3 graf-after--figure">Summary</h3><p name="8910" id="8910" class="graf graf--p graf-after--h3">So I walked you through a network call in this example. It showed you how you could leverage the power of enums with functions and generics to assist you with your closure returns. This also gave you another look at <code class="markup--code markup--p-code">@escaping</code> to give you more context in how it’s used.</p><p name="4a02" id="4a02" class="graf graf--p graf-after--p">I can’t promise that this network code is an optimized solution, but it is a solution.</p><p name="c691" id="c691" class="graf graf--p graf-after--p">You get a lot of flexibility in all of this and I’ve even seen solutions posted in <a href="https://stackoverflow.com/questions/31450971/swift-enums-that-use-closures#32530320" data-href="https://stackoverflow.com/questions/31450971/swift-enums-that-use-closures#32530320" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Stack Overflow</a> about how to use closures in enums to provide many paths for your code to take.</p><p name="94b7" id="94b7" class="graf graf--p graf-after--p">It’s a bit tough but when you actually write this out a few times, it makes more sense in how it works. Code autocompletion is a great teacher if you are paying attention.</p><h3 name="d85f" id="d85f" class="graf graf--h3 graf-after--p">What’s Next</h3><p name="cd0c" id="cd0c" class="graf graf--p graf-after--h3">We’ve been talking a lot about value types, I mean Swift <em class="markup--em markup--p-em">loves</em> it’s value types, but there are use cases where reference types come in. I think they are fascinating and dangerous if not used correctly.</p><p name="8501" id="8501" class="graf graf--p graf-after--p">So up next is inout, Lazy, and Getters and Setters.</p><p name="b526" id="b526" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">inout</code> is all about references, Lazy helps with performance, and getters and setters help you change how values are accessed.</p><p name="7352" id="7352" class="graf graf--p graf-after--p">Even though some might label these as miscellaneous things, they are extremely useful in various situations.</p><p name="a5af" id="a5af" class="graf graf--p graf-after--p">For now, we covered something new and slightly difficult which means…</p><p name="dd9f" id="dd9f" class="graf graf--p graf-after--p">Keep practicing.</p><div name="3bb3" id="3bb3" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://medium.com/@broebling/beginning-swift-programming-part-16-inout-lazy-and-getters-and-setters-99fe68cf8b54" data-href="https://medium.com/@broebling/beginning-swift-programming-part-16-inout-lazy-and-getters-and-setters-99fe68cf8b54" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/@broebling/beginning-swift-programming-part-16-inout-lazy-and-getters-and-setters-99fe68cf8b54"><strong class="markup--strong markup--mixtapeEmbed-strong">Beginning Swift Programming Part 16 — inout, Lazy, and Getters and Setters</strong><br><em class="markup--em markup--mixtapeEmbed-em">Previously we covered using Generics and Closures with Enums. In this lesson we are going to move away from all of this…</em>medium.com</a><a href="https://medium.com/@broebling/beginning-swift-programming-part-16-inout-lazy-and-getters-and-setters-99fe68cf8b54" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="c2e3fbc228ee9ad7319ba64b6f64fb2a" data-thumbnail-img-id="0*p7C4tOLuVi2sBtGs." style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*p7C4tOLuVi2sBtGs.);"></a></div><figure name="0cb1" id="0cb1" class="graf graf--figure graf-after--mixtapeEmbed graf--trailing"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 280px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 40%;"></div><a href="http://bit.ly/2KkkwGL" data-href="http://bit.ly/2KkkwGL" class="graf-imageAnchor" data-action="image-link" data-action-observe-only="true"rel="noopener"target="_blank"><img class="graf-image" data-image-id="1*5-oC2BqqizoRxIls08WMmA.png" data-width="1250" data-height="500" src="https://cdn-images-1.medium.com/max/800/1*5-oC2BqqizoRxIls08WMmA.png"></a></div></figure></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@broebling" class="p-author h-card">Bob Roebling</a> on <a href="https://medium.com/p/d1ce50102d7d"><time class="dt-published" datetime="2018-04-29T01:37:02.003Z">April 29, 2018</time></a>.</p><p><a href="https://medium.com/@broebling/beginning-swift-programming-part-15-enums-with-generics-and-closures-d1ce50102d7d" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on October 1, 2019.</p></footer></article></body></html>